# Milestone v1.5: Frequency Analysis + Polish

**Status:** SHIPPED 2026-02-12
**Phases:** 1-13
**Total Plans:** 13 phases (planning files lost mid-Phase 12; reconstructed from codebase)

## Overview

WordleBot v1.5 is a Chrome extension (Manifest V3) that provides real-time, entropy-based word suggestions on the NYT Wordle page. This milestone covers the full build from project setup through frequency-based scoring improvements and final polish.

## Phases

### Phase 1-5: Project Setup and Foundation

**Goal**: Establish project structure, manifest, icons, design documents, and architectural decisions.
**Plans**: 5 phases

Details:
- Chrome Manifest V3 configuration with storage permission
- Icon set (16, 48, 128px)
- Design docs: PROBLEM-STATEMENT.md, PRODUCT-SUMMARY.md, AI-DESIGN-DECISIONS.md, UX-ETHICAL-CONSTRAINTS.md, TEST-CHECKLIST.md, V2-ROADMAP.md

### Phase 6: UI Panel Foundation

**Goal**: Create Shadow DOM floating panel with theme detection and collapse/expand.
**Depends on**: Phase 1-5

Details:
- `panelUI.js` — Shadow DOM isolation from NYT styles
- Theme detection (dark/light) via body.classList + CSS variable fallback
- Collapse/expand toggle with localStorage persistence
- Responsive auto-collapse on narrow viewports
- Skeleton loading placeholders

### Phase 7: Suggestion Card Rendering

**Goal**: Render suggestion data with progressive disclosure and edge state handling.
**Depends on**: Phase 6

Details:
- `panelRenderer.js` — 3-state click cycle (collapsed / why line / full details)
- Edge states: 0 candidates, 1 candidate, solved, error
- Fade-in transitions, loading spinner, error messaging

### Phase 8: DOM Board Reader

**Goal**: Extract board state from NYT Wordle page and detect changes.
**Depends on**: Phase 6

Details:
- `domReader.js` — reads tile letter + status (correct/present/absent) from data-state attributes
- MutationObserver for real-time change detection with stabilization loop
- Polling fallback if board container not found
- Game status detection: in_progress, won, lost

### Phase 9: Constraint Engine

**Goal**: Filter dictionary by green/yellow/gray tile constraints.
**Depends on**: Phase 8

Details:
- `constraintEngine.js` — two-pass count-first-then-derive constraint model
- Handles duplicate letters correctly
- Per-guess delta tracking for game context narrative
- Memoization cache keyed by board state
- Returns candidate indices + constraint metadata

### Phase 10: Entropy Engine

**Goal**: Rank guesses by Shannon entropy with urgency-based blending.
**Depends on**: Phase 9

Details:
- `entropyEngine.js` — Shannon entropy computation over 243 feedback patterns
- Two-pass feedback pattern matching (handles duplicate letters)
- Pre-encoded words as Uint8Array(5) for hot-loop performance
- Dual recommendation tracks: bestInfoGuesses (exploration) + bestAnswerGuesses (answer-oriented)
- Urgency blending: pure entropy at 4+ guesses left, increasing commonness weight as guesses decrease
- First-guess cache (top 20) computed at init, persisted to chrome.storage.local
- Frequency-based tie-breaking when entropy values are equal

### Phase 11: Dictionary Extraction and Cascade

**Goal**: Extract word list from NYT Wordle's JS bundle at runtime with fallback cascade.
**Depends on**: Phase 10

Details:
- `dictExtractor.js` — multi-strategy bundle URL discovery (Performance API, DOM query, HTML fetch)
- Regex extraction of word arrays from JS bundle source
- Disambiguation: handles split (solutions + guesses) and combined (single merged list) formats
- `dictionary.js` — three-tier loading cascade: live extraction > chrome.storage.local cache > bundled fallback
- SHA-256 fingerprinting for cache invalidation
- 30-day staleness window, single retry after 12s on extraction failure
- Bundled `data/NYTWordleList.txt` (13,751 words) as last resort

### Phase 12: Frequency Analysis and Candidate Ranking

**Goal**: Improve frequency-based scoring so common words surface as strong openers over obscure dictionary words.
**Depends on**: Phase 11

Details:
- `frequencyTables.js` — letter frequency, positional frequency (letter-by-position), bigram adjacency
- `frequencyScorer.js` — weighted composite scoring (positional 60%, overall 30%, bigram 10%)
- Commonness pre-computation for all dictionary words
- `suggestionEngine.js` — opener near-tie random sampling (Fisher-Yates shuffle from cluster)
- Near-tie disclaimer restricted to opener mode only
- Late-game candidate classification (likely_answer vs rare_valid)

### Phase 13: Polish and Release

**Goal**: Fix edge cases, ensure non-blocking loading, finalize as v1.5.
**Depends on**: Phase 12

Details:
- Fixed click handler leak in panelRenderer (accumulated on every re-render)
- Added game-lost state handling (was showing stale suggestions after all 6 guesses used)
- Improved fallback dictionary labeling ("Using fallback dictionary -- stats may differ from live data")
- Version bump to 1.5.0, tagged v1.5

---

## Milestone Summary

**Key Decisions:**
- Use Shannon entropy as primary ranking signal, frequency as secondary/tie-breaker
- Compute all frequency stats over the full 5-letter NYT dictionary (no separate solution list, since NYT merged them)
- Three-tier dictionary cascade (extract > cache > bundled) for resilience
- Shadow DOM isolation to prevent NYT style interference
- Urgency blending: shift from pure entropy to commonness as guesses decrease
- requestIdleCallback for deferred computation (non-blocking)
- Near-tie random sampling to avoid deterministic top-5 in opener mode

**Issues Resolved:**
- Click handler leak causing N-fold card state cycling after N guesses
- Game-lost state falling through to mid_game/late_game suggestions
- Bundled fallback not clearly labeled as degraded source

**Technical Debt Incurred:**
- No automated tests (TEST-CHECKLIST.md exists but is manual)
- Dictionary staleness window is 30 days (could miss NYT updates sooner)
- Planning files lost mid-Phase 12 (not committed to git)

---

_For current project status, see .planning/PROJECT.md_
